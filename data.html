<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Data — Syndicate</title>

  <!-- Libraries -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

  <style>
    * { transition: all 0.25s ease-in-out; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to bottom right, #0f172a, #1e293b);
      color: #fff;
    }

    nav a {
      position: relative;
      transition: color 0.3s ease;
    }
    nav a::after {
      content: "";
      position: absolute;
      bottom: -4px;
      left: 50%;
      transform: translateX(-50%) scaleX(0);
      width: 60%;
      height: 2px;
      background: linear-gradient(to right,#60a5fa,#3b82f6);
      border-radius: 9999px;
      opacity: 0.8;
      transition: transform 0.3s ease-in-out;
    }
    nav a:hover::after { transform: translateX(-50%) scaleX(1); }
    .active-link { color:#60a5fa; font-weight:600; }
    .active-link::after { transform:translateX(-50%) scaleX(1); opacity:.9; }

    /* Glass + Glow */
    .glass { background: rgba(255,255,255,0.07); backdrop-filter: blur(14px); border: 1px solid rgba(255,255,255,0.08); }
    .card-glow { box-shadow: 0 8px 24px rgba(59,130,246,0.12); border-radius:16px; }

    /* Table */
    thead th { position: sticky; top: 0; z-index: 5; backdrop-filter: blur(10px); background: rgba(15,23,42,0.9); }
    tbody tr:hover { background-color: rgba(255,255,255,0.05); box-shadow: 0 0 8px rgba(255,255,255,0.06); }
    td canvas { width: 80px !important; height: 30px !important; }

    /* Loader shimmer */
    @keyframes shimmer {
      0% { background-position: -500px 0; }
      100% { background-position: 500px 0; }
    }
    .shimmer {
      background: linear-gradient(to right, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.05) 100%);
      background-size: 1000px 100%;
      animation: shimmer 1.6s infinite linear;
    }

    /* Responsive Fixes */
    @media (max-width: 1024px) {
      .glass { padding: 1.5rem; }
      .card-glow { box-shadow: none; }
    }

    @media (max-width: 768px) {
      main { padding: 1rem; }
      table { font-size: 0.8rem; }
      th, td { padding: 0.5rem !important; }
      select { width: 100%; }
      h1 { font-size: 1.75rem; }
    }

    @media (max-width: 480px) {
      h1 { font-size: 1.4rem; }
      .glass { border-radius: 12px; padding: 1rem; }
      footer { font-size: 0.7rem; }
    }
  </style>
</head>

<body class="min-h-screen flex flex-col">

<!-- ✅ NAVBAR -->
<header id="navbar" class="fixed top-0 left-1/2 -translate-x-1/2 z-50 w-full md:w-[95%] bg-white/20 dark:bg-slate-900/40 backdrop-blur-2xl border-b border-white/10 transition-all duration-500 overflow-hidden">
  <div class="flex items-center justify-between h-16 px-4 md:px-6 relative">
    <a href="index.html" class="flex items-center gap-3">
      <div class="w-9 h-9 rounded-md bg-gradient-to-br from-blue-700 to-yellow-400 flex items-center justify-center text-white font-bold text-lg">S</div>
      <div class="flex flex-col leading-tight">
        <h1 class="text-lg font-bold text-white">Syndicate</h1>
        <p class="text-xs text-gray-300 -mt-1">Battling Corruption</p>
      </div>
    </a>

    <!-- Hamburger -->
    <button id="menu-btn" class="md:hidden w-7 h-7 relative flex flex-col justify-center items-center focus:outline-none">
      <span class="bar absolute w-6 h-[2px] bg-white rounded transition-all duration-300 origin-center"></span>
      <span class="bar absolute w-6 h-[2px] bg-white rounded transition-all duration-300 origin-center mt-2"></span>
    </button>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex gap-6 text-slate-200">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="data.html" class="active-link">Data</a>
      <a href="charts.html">Charts</a>
      <a href="reports.html">Reports</a>
      <a href="team.html">Team</a>
      <a href="contact.html">Contact</a>
      <a href="community.html">Community</a>
    </nav>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden flex-col justify-center items-center text-center bg-slate-900/90 backdrop-blur-2xl text-white py-8 space-y-5 border border-slate-700 transform scale-y-0 origin-top opacity-0 translate-y-5 transition-all duration-500 rounded-2xl shadow-2xl w-[90%] mx-auto mt-2 mb-3">
    <a href="index.html" class="block hover:text-yellow-400">Home</a>
    <a href="about.html" class="block hover:text-yellow-400">About</a>
    <a href="data.html" class="block text-yellow-400 font-semibold">Data</a>
    <a href="charts.html" class="block hover:text-yellow-400">Charts</a>
    <a href="reports.html" class="block hover:text-yellow-400">Reports</a>
    <a href="team.html" class="block hover:text-yellow-400">Team</a>
    <a href="contact.html" class="block hover:text-yellow-400">Contact</a>
    <a href="community.html" class="block hover:text-yellow-400 pb-3">Community</a>
  </div>
</header>

<!-- HERO -->
<section class="min-h-[50vh] flex items-center justify-center pt-24 px-4 text-center bg-gradient-to-b from-slate-900 to-slate-800">
  <div class="max-w-3xl" data-aos="fade-up">
    <h1 class="text-3xl md:text-5xl font-extrabold leading-tight">Data Calendar — Philippines</h1>
    <p class="mt-3 text-slate-300 text-base md:text-lg">
      Explore nationwide governance and corruption indicators across years.<br>
      Use the selectors below to focus on specific time periods.
    </p>
  </div>
</section>

<!-- MAIN CONTENT -->
<main class="max-w-6xl mx-auto px-4 md:px-6 py-12 space-y-8">
  <!-- Dropdown Filters -->
  <div class="glass p-5 md:p-8 rounded-2xl flex flex-col sm:flex-row flex-wrap gap-4 justify-center card-glow" data-aos="fade-up">
    <div class="flex flex-col items-center">
      <label for="startYear" class="text-sm text-slate-400 mb-1">Start Year</label>
      <select id="startYear" class="p-2 rounded-md bg-slate-800 text-white border border-slate-700 focus:ring-2 focus:ring-blue-500"></select>
    </div>
    <div class="flex flex-col items-center">
      <label for="endYear" class="text-sm text-slate-400 mb-1">End Year</label>
      <select id="endYear" class="p-2 rounded-md bg-slate-800 text-white border border-slate-700 focus:ring-2 focus:ring-blue-500"></select>
    </div>
  </div>

  <!-- Loader -->
  <div id="loader" class="glass rounded-2xl p-6 text-center text-slate-400 text-sm shimmer card-glow">Loading data...</div>

  <!-- Table Section -->
  <section id="tableSection" class="hidden glass rounded-2xl p-5 border border-white/10 overflow-hidden card-glow" data-aos="fade-up">
    <h4 class="text-lg font-semibold mb-4 text-slate-100">Indicator Data</h4>
    <div class="overflow-x-auto max-h-[60vh] overflow-y-auto rounded-xl">
      <table class="w-full text-sm text-left text-slate-300 border-collapse min-w-[600px]">
        <thead class="text-xs uppercase text-slate-400 border-b border-slate-700">
          <tr>
            <th class="p-2">Indicator</th>
            <th class="p-2 text-right">Min</th>
            <th class="p-2 text-right">Max</th>
            <th class="p-2 text-right">Average</th>
            <th class="p-2 text-right">Change</th>
            <th class="p-2 text-center">Trend</th>
          </tr>
        </thead>
        <tbody id="dataTable" class="divide-y divide-slate-800"></tbody>
      </table>
    </div>
  </section>

  <!-- CTA -->
  <section class="glass rounded-2xl p-6 text-center border border-white/10 card-glow" data-aos="fade-up">
    <h3 class="text-xl font-semibold text-white">Visualize This Data</h3>
    <p class="text-slate-300 mt-2 text-sm md:text-base">Dive deeper into interactive charts and trend analysis.</p>
    <a href="charts.html" class="inline-block mt-4 px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-400 text-slate-900 font-semibold rounded-lg shadow hover:opacity-90 transition">View Charts →</a>
  </section>
</main>

<footer class="bg-slate-100 dark:bg-slate-800 border-t border-slate-700 py-5 text-center text-xs md:text-sm text-slate-500 dark:text-slate-400">
  © 2025 Syndicate — Data from World Bank • COA • PhilGEPS
</footer>

<!-- ✅ JavaScript -->
<script>
AOS.init({ duration: 900, once: true });

const navbar=document.getElementById('navbar');
const menuBtn=document.getElementById('menu-btn');
const mobileMenu=document.getElementById('mobile-menu');
const bars=menuBtn.querySelectorAll('.bar');

menuBtn.addEventListener('click',()=>{
  const open=mobileMenu.classList.contains('scale-y-100');
  if(!open){
    mobileMenu.classList.remove('hidden');
    setTimeout(()=>mobileMenu.classList.add('flex','scale-y-100','opacity-100'),10);
    bars[0].classList.add('rotate-45','translate-y-[4px]');
    bars[1].classList.add('-rotate-45','-translate-y-[4px]');
  }else{
    mobileMenu.classList.remove('scale-y-100','opacity-100');
    setTimeout(()=>{mobileMenu.classList.remove('flex');mobileMenu.classList.add('hidden');},400);
    bars[0].classList.remove('rotate-45','translate-y-[4px]');
    bars[1].classList.remove('-rotate-45','-translate-y-[4px]');
  }
});

window.addEventListener('scroll',()=>{
  if(window.scrollY>10){
    navbar.classList.add('top-3','w-[95%]','rounded-3xl','shadow-lg','bg-white/30','dark:bg-slate-900/50');
  } else {
    navbar.classList.remove('top-3','w-[95%]','rounded-3xl','shadow-lg','bg-white/30','dark:bg-slate-900/50');
  }
});

const state={data:[],chartRefs:{}};
function parseNum(v){const s=String(v||"").replace(/[, ]/g,"");const n=parseFloat(s);return isNaN(n)?null:n;}
function extract(r,ys){return ys.map(y=>({y:+y,v:parseNum(r[y])})).filter(p=>p.v!=null);}
function renderSparkline(ctx,vals){
  const diff=vals.at(-1).v-vals[0].v;
  let color=diff>0?"#16a34a":diff<0?"#dc2626":"#64748b";
  const grad=ctx.createLinearGradient(0,0,0,30);
  grad.addColorStop(0,color+"40");grad.addColorStop(1,color+"05");
  return new Chart(ctx,{type:"line",data:{labels:vals.map(v=>v.y),datasets:[{data:vals.map(v=>v.v),borderColor:color,backgroundColor:grad,fill:true,tension:0.3,pointRadius:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}});
}
function renderTable(years){
  const tbody=document.getElementById("dataTable");
  tbody.innerHTML="";
  state.data.forEach(r=>{
    const vals=extract(r,years);
    if(!vals.length)return;
    const arr=vals.map(v=>v.v);
    const min=Math.min(...arr),max=Math.max(...arr);
    const avg=(arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(2);
    const chg=((arr.at(-1)-arr[0])/Math.abs(arr[0])*100).toFixed(1);
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td class="p-2">${r.SeriesName}</td>
      <td class="p-2 text-right">${min.toFixed(2)}</td>
      <td class="p-2 text-right">${max.toFixed(2)}</td>
      <td class="p-2 text-right">${avg}</td>
      <td class="p-2 text-right">${chg>0?`<span class='text-green-500'>+${chg}%</span>`:chg<0?`<span class='text-red-500'>${chg}%</span>`:`<span class='text-slate-400'>0%</span>`}</td>
      <td class="p-2 text-center"><canvas></canvas></td>`;
    tbody.appendChild(tr);
    const ctx=tr.querySelector("canvas").getContext("2d");
    renderSparkline(ctx,vals);
  });
}
function updateDropdowns(){
  const start=document.getElementById("startYear"),end=document.getElementById("endYear");
  const s=+start.value,e=+end.value;
  Array.from(start.options).forEach(opt=>opt.disabled=+opt.value>e);
  Array.from(end.options).forEach(opt=>opt.disabled=+opt.value<s);
}
function init(){
  Papa.parse("Data.csv",{download:true,header:true,complete:res=>{
    state.data=res.data.filter(r=>String(r.CountryName||r["Country Name"]||"").toLowerCase()=="philippines");
    const years=Object.keys(state.data[0]).filter(k=>/^\d{4}$/.test(k)).map(Number).sort((a,b)=>a-b);
    const start=document.getElementById("startYear"),end=document.getElementById("endYear");
    years.forEach(y=>{
      start.innerHTML+=`<option value="${y}">${y}</option>`;
      end.innerHTML+=`<option value="${y}">${y}</option>`;
    });
    start.value=years[0]; end.value=years.at(-1);
    updateDropdowns();
    renderTable(years);
    document.getElementById("loader").classList.add("hidden");
    document.getElementById("tableSection").classList.remove("hidden");
    start.addEventListener("change",()=>{updateDropdowns();renderTable(years.filter(y=>y>=+start.value&&y<=+end.value));});
    end.addEventListener("change",()=>{updateDropdowns();renderTable(years.filter(y=>y>=+start.value&&y<=+end.value));});
  }});
}
document.addEventListener("DOMContentLoaded",init);
</script>
</body>
</html>
